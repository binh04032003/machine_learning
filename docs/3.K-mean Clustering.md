`K-means clustering (phÃ¢n cá»¥m K-means)` laÌ€ má»™t trong nhá»¯ng thuáº­t toÃ¡n cÆ¡ báº£n nháº¥t trong `Unsupervised learning`.

# 1. GiÆ¡Ìi thiÃªÌ£u
Trong thuáº­t toÃ¡n `K-means clustering`, chÃºng ta khÃ´ng biáº¿t `nhÃ£n (label)` cá»§a tá»«ng Ä‘iá»ƒm dá»¯ liá»‡u. Má»¥c Ä‘Ã­ch lÃ  lÃ m thá»ƒ nÃ o Ä‘á»ƒ phÃ¢n dá»¯ liá»‡u thÃ nh **cÃ¡c `cá»¥m (cluster)` khÃ¡c nhau** sao cho dá»¯ liá»‡u trong cÃ¹ng má»™t cá»¥m cÃ³ **tÃ­nh cháº¥t giá»‘ng nhau**.

Ã tÆ°á»Ÿng Ä‘Æ¡n giáº£n nháº¥t vá» cluster (cá»¥m) lÃ  táº­p há»£p cÃ¡c Ä‘iá»ƒm á»Ÿ gáº§n nhau trong má»™t khÃ´ng gian nÃ o Ä‘Ã³ (khÃ´ng gian nÃ y cÃ³ thá»ƒ cÃ³ ráº¥t nhiá»u chiá»u trong trÆ°á»ng há»£p thÃ´ng tin vá» má»™t Ä‘iá»ƒm dá»¯ liá»‡u lÃ  ráº¥t lá»›n).

HÃ¬nh bÃªn dÆ°á»›i lÃ  vÃ­ dá»¥ vá» 3 cá»¥m dá»¯ liá»‡u (cluster).

![](../imgs/34.png)

Giáº£ sá»­ má»—i cluster cÃ³ má»™t Ä‘iá»ƒm Ä‘áº¡i diá»‡n (center) mÃ u vÃ ng. VÃ  nhá»¯ng Ä‘iá»ƒm xung quanh má»—i center thuá»™c vÃ o cÃ¹ng nhÃ³m vá»›i center Ä‘Ã³. Khi xÃ©t má»™t Ä‘iá»ƒm báº¥t ká»³, ta xÃ©t xem Ä‘iá»ƒm Ä‘Ã³ gáº§n vá»›i center nÃ o nháº¥t thÃ¬ nÃ³ thuá»™c vá» cÃ¹ng nhÃ³m vá»›i center Ä‘Ã³.


# 2. PhÃ¢n tiÌch toaÌn hoÌ£c
Má»¥c Ä‘Ã­ch cuá»‘i cÃ¹ng cá»§a thuáº­t toÃ¡n phÃ¢n nhÃ³m nÃ y lÃ : tá»« dá»¯ liá»‡u Ä‘áº§u vÃ o vÃ  sá»‘ lÆ°á»£ng nhÃ³m chÃºng ta muá»‘n tÃ¬m, hÃ£y chá»‰ ra center cá»§a má»—i nhÃ³m vÃ  phÃ¢n cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u vÃ o cÃ¡c nhÃ³m tÆ°Æ¡ng á»©ng. Giáº£ sá»­ thÃªm ráº±ng má»—i Ä‘iá»ƒm dá»¯ liá»‡u chá»‰ thuá»™c vÃ o Ä‘Ãºng má»™t nhÃ³m.
## 2.1 Má»™t sá»‘ kÃ½ hiá»‡u toÃ¡n há»c
![](../imgs/17.png)

BiÃªÌ‰u diÃªÌƒn `one-hot`:

![](../imgs/35.png)

## 2.2 HaÌ€m mÃ¢Ìt maÌt vaÌ€ baÌ€i toaÌn tÃ´Ìi Æ°u
Náº¿u ta coi center m(k) lÃ  center (hoáº·c representative) cá»§a má»—i cluster vÃ  Æ°á»›c lÆ°á»£ng táº¥t cáº£ cÃ¡c Ä‘iá»ƒm Ä‘Æ°á»£c phÃ¢n vÃ o cluster nÃ y bá»Ÿi m(k), thÃ¬ má»™t Ä‘iá»ƒm dá»¯ liá»‡u x(i) Ä‘Æ°á»£c phÃ¢n vÃ o cluster k sáº½ bá»‹ sai sá»‘ lÃ  x(i)âˆ’m(k). ChÃºng ta mong muá»‘n sai sá»‘ nÃ y cÃ³ trá»‹ tuyá»‡t Ä‘á»‘i nhá» nháº¥t nÃªn ta sáº½ tÃ¬m cÃ¡ch Ä‘á»ƒ Ä‘áº¡i lÆ°á»£ng sau Ä‘Ã¢y Ä‘áº¡t giÃ¡ trá»‹ nhá» nháº¥t:

![](../imgs/36.png)

HÆ¡n ná»¯a, vÃ¬ xi Ä‘Æ°á»£c phÃ¢n vÃ o cluster k nÃªn y(ik)=1,y(ij)=0, âˆ€jâ‰ k. Khi Ä‘Ã³, biá»ƒu thá»©c bÃªn trÃªn sáº½ Ä‘Æ°á»£c viáº¿t láº¡i lÃ :

![](../imgs/39.png)

Sai sá»‘ cho toÃ n bá»™ dá»¯ liá»‡u sáº½ lÃ :

![](../imgs/38.png)
## 2.3 Thuáº­t toÃ¡n tá»‘i Æ°u hÃ m máº¥t mÃ¡t
### 2.3.1 Cá»‘ Ä‘á»‹nh M, tÃ¬m Y
Giáº£ sá»­ Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c cÃ¡c centers, hÃ£y tÃ¬m cÃ¡c label vector Ä‘á»ƒ hÃ m máº¥t mÃ¡t Ä‘áº¡t giÃ¡ trá»‹ nhá» nháº¥t. Äiá»u nÃ y tÆ°Æ¡ng Ä‘Æ°Æ¡ng vá»›i viá»‡c tÃ¬m cluster cho má»—i Ä‘iá»ƒm dá»¯ liá»‡u.

Khi cÃ¡c centers lÃ  cá»‘ Ä‘á»‹nh, bÃ i toÃ¡n tÃ¬m label vector cho toÃ n bá»™ dá»¯ liá»‡u cÃ³ thá»ƒ Ä‘Æ°á»£c chia nhá» thÃ nh bÃ i toÃ¡n tÃ¬m label vector cho tá»«ng Ä‘iá»ƒm dá»¯ liá»‡u 
x(i) nhÆ° sau:

![](../imgs/40.png)

VÃ¬ chá»‰ cÃ³ má»™t pháº§n tá»­ cá»§a label vector y(i) báº±ng 1 nÃªn bÃ i toÃ¡n cÃ³ thá»ƒ tiáº¿p tá»¥c Ä‘Æ°á»£c viáº¿t dÆ°á»›i dáº¡ng Ä‘Æ¡n giáº£n hÆ¡n:

![](../imgs/41.png)
### 2.3.2 CÃ´Ì Ä‘iÌ£nh Y, tiÌ€m M
Giáº£ sá»­ Ä‘Ã£ tÃ¬m Ä‘Æ°á»£c cluster cho tá»«ng Ä‘iá»ƒm, hÃ£y tÃ¬m center má»›i cho má»—i cluster Ä‘á»ƒ hÃ m máº¥t mÃ¡t Ä‘áº¡t giÃ¡ trá»‹ nhá» nháº¥t.

Má»™t khi chÃºng ta Ä‘Ã£ xÃ¡c Ä‘á»‹nh Ä‘Æ°á»£c label vector cho tá»«ng Ä‘iá»ƒm dá»¯ liá»‡u, bÃ i toÃ¡n tÃ¬m center cho má»—i cluster Ä‘Æ°á»£c rÃºt gá»n thÃ nh:

![](../imgs/42.png)

![](../imgs/43.png)

Hay nÃ³i má»™t cÃ¡ch Ä‘Æ¡n giáº£n: **m(j) lÃ  trung bÃ¬nh cá»™ng cá»§a cÃ¡c Ä‘iá»ƒm trong cluster j**.
## 2.4 TÃ³m táº¯t thuáº­t toÃ¡n
**Äáº§u vÃ o:** Dá»¯ liá»‡u X vÃ  sá»‘ lÆ°á»£ng cluster cáº§n tÃ¬m K.

**Äáº§u ra:** CÃ¡c center M vÃ  label vector cho tá»«ng Ä‘iá»ƒm dá»¯ liá»‡u Y.

1. *Chá»n K Ä‘iá»ƒm báº¥t ká»³ lÃ m cÃ¡c center ban Ä‘áº§u.*
- Chá»n ngáº«u nhiÃªn ğ¾ Ä‘iá»ƒm tá»« táº­p dá»¯ liá»‡u hoáº·c chá»n ngáº«u nhiÃªn trong khÃ´ng gian dá»¯ liá»‡u Ä‘á»ƒ lÃ m trung tÃ¢m cá»¥m ban Ä‘áº§u.
- CÃ¡c Ä‘iá»ƒm nÃ y táº¡m thá»i coi lÃ  Ä‘áº¡i diá»‡n cho cÃ¡c cá»¥m.

2. *PhÃ¢n má»—i Ä‘iá»ƒm dá»¯ liá»‡u vÃ o cluster cÃ³ center gáº§n nÃ³ nháº¥t.*
- Vá»›i má»—i Ä‘iá»ƒm dá»¯ liá»‡u ğ‘¥ğ‘–, tÃ­nh khoáº£ng cÃ¡ch tá»« nÃ³ Ä‘áº¿n táº¥t cáº£ cÃ¡c centroid.
- GÃ¡n Ä‘iá»ƒm Ä‘Ã³ vÃ o cá»¥m cÃ³ centroid gáº§n nháº¥t.
 
3. *Náº¿u viá»‡c gÃ¡n dá»¯ liá»‡u vÃ o tá»«ng cluster á»Ÿ bÆ°á»›c 2 khÃ´ng thay Ä‘á»•i so vá»›i vÃ²ng láº·p trÆ°á»›c nÃ³ thÃ¬ ta dá»«ng thuáº­t toÃ¡n.*
- Náº¿u khÃ´ng cÃ³ sá»± thay Ä‘á»•i (hoáº·c ráº¥t nhá») â†’ Dá»ªNG.
- Náº¿u cÃ³ thay Ä‘á»•i â†’ tiáº¿p tá»¥c.

4. *Cáº­p nháº­t center cho tá»«ng cluster báº±ng cÃ¡ch láº¥y trung bÃ¬nh cá»™ng cá»§a táº¥t cÃ¡c cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c gÃ¡n vÃ o cluster Ä‘Ã³ sau bÆ°á»›c 2.*
- Vá»›i má»—i cá»¥m, tÃ­nh trung bÃ¬nh cá»™ng táº¥t cáº£ cÃ¡c Ä‘iá»ƒm trong cá»¥m.
- Äiá»ƒm trung bÃ¬nh má»›i nÃ y sáº½ trá»Ÿ thÃ nh centroid má»›i cho cá»¥m.

   ![](../imgs/16.png)

5. *Quay láº¡i bÆ°á»›c 2.*
- Tiáº¿p tá»¥c láº·p láº¡i viá»‡c gÃ¡n cá»¥m â†’ cáº­p nháº­t centroid cho Ä‘áº¿n khi Centroid khÃ´ng Ä‘á»•i Ä‘Ã¡ng ká»ƒ, hoáº·c Ä‘áº¡t sá»‘ vÃ²ng láº·p tá»‘i Ä‘a.

